#include <iostream>
#include <fstream>
#include <string>
#include <filesystem>
namespace fs = std::filesystem;

int main() {
    std::string sourceFile, destinationDir;
    std::cout << "Enter source file path: ";
    std::cin >> sourceFile;
    std::cout << "Enter destination directory: ";
    std::cin >> destinationDir;

    // Make sure the destination directory exists
    if (!fs::exists(destinationDir)) {
        fs::create_directories(destinationDir);
    }

    // Construct a hidden destination filename (starts with dot)
    std::string destFileName = ".hidden_" + fs::path(sourceFile).filename().string();
    fs::path destPath = fs::path(destinationDir) / destFileName;

    std::ifstream src(sourceFile, std::ios::binary);
    std::ofstream dst(destPath, std::ios::binary);

    if (!src.is_open()) {
        std::cerr << "Error opening source file: " << sourceFile << std::endl;
        return 1;
    }

    if (!dst.is_open()) {
        std::cerr << "Error creating destination file: " << destPath << std::endl;
        return 1;
    }
    dst << src.rdbuf();

    std::cout << "File copied and hidden as " << destFileName << std::endl;
    return 0;
}
